/* Copyright 2012 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var e=function(){let e,t=!1;function n(){const e=document.querySelectorAll("span[data-font-name]");for(const t of e)t.className="debuggerHideText"}function a(e,t){const n=document.querySelectorAll(`span[data-font-name=${e}]`);for(const e of n)e.className=t?"debuggerShowText":"debuggerHideText"}function o(e){if(!e.target.dataset.fontName||"SPAN"!==e.target.tagName.toUpperCase())return;const t=e.target.dataset.fontName,n=document.getElementsByTagName("input");for(let e=0;e<n.length;++e){const o=n[e];o.dataset.fontName===t&&(o.checked=!o.checked,a(t,o.checked),o.scrollIntoView())}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(t){const a=this.panel,o=document.createElement("button");o.addEventListener("click",n),o.textContent="Refresh",a.appendChild(o),e=document.createElement("div"),a.appendChild(e)},cleanup:function(){e.textContent=""},enabled:!1,get active(){return t},set active(e){t=e,t?(document.body.addEventListener("click",o,!0),n()):(document.body.removeEventListener("click",o,!0),function(){const e=document.querySelectorAll("span[data-font-name]");for(const t of e)t.className=""}())},fontAdded:function(t,o){const i=function(e,t){const n=document.createElement("table");for(let a=0;a<t.length;a++){const o=document.createElement("tr"),i=document.createElement("td");i.textContent=t[a],o.appendChild(i);const s=document.createElement("td");s.textContent=e[t[a]].toString(),o.appendChild(s),n.appendChild(o)}return n}(t,["name","type"]),s=t.loadedName,d=document.createElement("div"),l=document.createElement("span");l.textContent=s;const c=document.createElement("a");o?(o=/url\(['"]?([^)"']+)/.exec(o),c.href=o[1]):t.data&&(c.href=URL.createObjectURL(new Blob([t.data],{type:t.mimeType}))),c.textContent="Download";const r=document.createElement("a");r.href="",r.textContent="Log",r.addEventListener("click",(function(e){e.preventDefault(),console.log(t)}));const p=document.createElement("input");p.setAttribute("type","checkbox"),p.dataset.fontName=s,p.addEventListener("click",(function(){a(s,p.checked)})),d.appendChild(p),d.appendChild(l),d.appendChild(document.createTextNode(" ")),d.appendChild(c),d.appendChild(document.createTextNode(" ")),d.appendChild(r),d.appendChild(i),e.appendChild(d),setTimeout((()=>{this.active&&n()}),2e3)}}}();let t;var n=function(){let e=[],n=null,o=null,i=null,s=Object.create(null);return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(e){const a=this;o=document.createElement("div"),i=document.createElement("select"),i.addEventListener("change",(function(e){a.selectStepper(this.value)})),o.appendChild(i),n=document.createElement("div"),this.panel.appendChild(o),this.panel.appendChild(n),sessionStorage.getItem("pdfjsBreakPoints")&&(s=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))),t=Object.create(null);for(const n in e.OPS)t[e.OPS[n]]=n},cleanup:function(){i.textContent="",n.textContent="",e=[]},enabled:!1,active:!1,create:function(t){const o=document.createElement("div");o.id="stepper"+t,o.hidden=!0,o.className="stepper",n.appendChild(o);const d=document.createElement("option");d.textContent="Page "+(t+1),d.value=t,i.appendChild(d);const l=s[t]||[],c=new a(o,t,l);return e.push(c),1===e.length&&this.selectStepper(t,!1),c},selectStepper:function(t,n){let a;for(t|=0,n&&this.manager.selectPanel(this),a=0;a<e.length;++a){const n=e[a];n.panel.hidden=n.pageIndex!==t}const o=i.options;for(a=0;a<o.length;++a){const e=o[a];e.selected=(0|e.value)===t}},saveBreakPoints:function(e,t){s[e]=t,sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(s))}}}();const a=function(){function e(e,t){const n=document.createElement(e);return t&&(n.textContent=t),n}function a(e){if("string"==typeof e){const t=75;return e.length<=t?e:e.substring(0,t)+"..."}if("object"!=typeof e||null===e)return e;if("length"in e){const t=10,n=[];let o,i;for(o=0,i=Math.min(t,e.length);o<i;o++)n.push(a(e[o]));return o<e.length&&n.push("..."),n}const t={};for(const n in e)t[n]=a(e[n]);return t}return class{constructor(e,t,n){this.panel=e,this.breakPoint=0,this.nextBreakPoint=null,this.pageIndex=t,this.breakPoints=n,this.currentIdx=-1,this.operatorListIdx=0,this.indentLevel=0}init(t){const n=this.panel,a=e("div","c=continue, s=step"),o=e("table");a.appendChild(o),o.cellSpacing=0;const i=e("tr");o.appendChild(i),i.appendChild(e("th","Break")),i.appendChild(e("th","Idx")),i.appendChild(e("th","fn")),i.appendChild(e("th","args")),n.appendChild(a),this.table=o,this.updateOperatorList(t)}updateOperatorList(o){const i=this;function s(){const e=+this.dataset.idx;this.checked?i.breakPoints.push(e):i.breakPoints.splice(i.breakPoints.indexOf(e),1),n.saveBreakPoints(i.pageIndex,i.breakPoints)}if(this.operatorListIdx>15e3)return;const d=document.createDocumentFragment(),l=Math.min(15e3,o.fnArray.length);for(let n=this.operatorListIdx;n<l;n++){const i=e("tr");i.className="line",i.dataset.idx=n,d.appendChild(i);const l=this.breakPoints.includes(n),c=o.argsArray[n]||[],r=e("td"),p=e("input");p.type="checkbox",p.className="points",p.checked=l,p.dataset.idx=n,p.onclick=s,r.appendChild(p),i.appendChild(r),i.appendChild(e("td",n.toString()));const h=t[o.fnArray[n]];let u=c;if("showText"===h){const t=c[0],n=e("tr"),a=e("tr"),o=e("tr");for(let i=0;i<t.length;i++){const s=t[i];if("object"==typeof s&&null!==s)n.appendChild(e("td",s.originalCharCode)),a.appendChild(e("td",s.fontChar)),o.appendChild(e("td",s.unicode));else{const t=e("td",s);t.classList.add("advance"),n.appendChild(t),a.appendChild(e("td")),o.appendChild(e("td"))}}u=e("td");const i=e("table");i.classList.add("showText"),u.appendChild(i),i.appendChild(n),i.appendChild(a),i.appendChild(o)}else"restore"===h&&this.indentLevel--;i.appendChild(e("td"," ".repeat(2*this.indentLevel)+h)),"save"===h&&this.indentLevel++,u instanceof HTMLElement?i.appendChild(u):i.appendChild(e("td",JSON.stringify(a(u))))}if(l<o.fnArray.length){const t=e("td","...");t.colspan=4,d.appendChild(t)}this.operatorListIdx=o.fnArray.length,this.table.appendChild(d)}getNextBreakPoint(){this.breakPoints.sort((function(e,t){return e-t}));for(let e=0;e<this.breakPoints.length;e++)if(this.breakPoints[e]>this.currentIdx)return this.breakPoints[e];return null}breakIt(e,t){n.selectStepper(this.pageIndex,!0),this.currentIdx=e;const a=e=>{switch(e.keyCode){case 83:document.removeEventListener("keydown",a),this.nextBreakPoint=this.currentIdx+1,this.goTo(-1),t();break;case 67:document.removeEventListener("keydown",a),this.nextBreakPoint=this.getNextBreakPoint(),this.goTo(-1),t()}};document.addEventListener("keydown",a),this.goTo(e)}goTo(e){const t=this.panel.getElementsByClassName("line");for(let n=0,a=t.length;n<a;++n){const a=t[n];(0|a.dataset.idx)===e?(a.style.backgroundColor="rgb(251,250,207)",a.scrollIntoView()):a.style.backgroundColor=null}}}}();var o=function(){let e=[];function t(e){e.textContent=""}return{id:"Stats",name:"Stats",panel:null,manager:null,init(e){},enabled:!1,active:!1,add(n,a){if(!a)return;const o=function(t){for(let n=0,a=e.length;n<a;++n)if(e[n].pageNumber===t)return n;return!1}(n);!1!==o&&(e[o].div.remove(),e.splice(o,1));const i=document.createElement("div");i.className="stats";const s=document.createElement("div");s.className="title",s.textContent="Page: "+n;const d=document.createElement("div");d.textContent=a.toString(),i.appendChild(s),i.appendChild(d),e.push({pageNumber:n,div:i}),e.sort((function(e,t){return e.pageNumber-t.pageNumber})),t(this.panel);for(let t=0,n=e.length;t<n;++t)this.panel.appendChild(e[t].div)},cleanup(){e=[],t(this.panel)}}}();window.PDFBug=function(){const t=[];let a=null;return{tools:[e,n,o],enable(e){const t=1===e.length&&"all"===e[0],n=this.tools;for(let a=0;a<n.length;++a){const o=n[a];(t||e.includes(o.id))&&(o.enabled=!0)}t||n.sort((function(t,a){let o=e.indexOf(t.id);o=o<0?n.length:o;let i=e.indexOf(a.id);return i=i<0?n.length:i,o-i}))},init(e,n,a){this.enable(a);const o=document.createElement("div");o.id="PDFBug";const i=document.createElement("div");i.setAttribute("class","controls"),o.appendChild(i);const s=document.createElement("div");s.setAttribute("class","panels"),o.appendChild(s),n.appendChild(o),n.style.right="300px";const d=this.tools,l=this;for(let n=0;n<d.length;++n){const a=d[n],o=document.createElement("div"),c=document.createElement("button");c.textContent=a.name,c.addEventListener("click",function(e){return function(t){t.preventDefault(),l.selectPanel(e)}}(n)),i.appendChild(c),s.appendChild(o),a.panel=o,a.manager=this,a.enabled?a.init(e):o.textContent=`${a.name} is disabled. To enable add "${a.id}" to the pdfBug parameter and refresh (separate multiple by commas).`,t.push(c)}this.selectPanel(0)},cleanup(){for(let e=0,t=this.tools.length;e<t;e++)this.tools[e].enabled&&this.tools[e].cleanup()},selectPanel(e){if("number"!=typeof e&&(e=this.tools.indexOf(e)),e===a)return;a=e;const n=this.tools;for(let a=0;a<n.length;++a){const o=a===e;t[a].classList.toggle("active",o),n[a].active=o,n[a].panel.hidden=!o}}}}();